CREATE OR REPLACE FUNCTION GET_ID(P_YOE IN NUMBER, P_DEPT IN NUMBER , P_PROG IN NUMBER)
RETURN NUMBER
IS
V_ID NUMBER;
BEGIN
SELECT MAX(ID) INTO V_ID
FROM Students
WHERE YOE = P_YOE AND DEPT = P_DEPT AND Prog = P_Prog;

IF V_ID IS NULL --- Does not exist
THEN
	V_ID := TO_NUMBER(TO_CHAR(P_YOE) || '00' || TO_CHAR(P_DEPT) || TO_CHAR(P_PROG) || '101');
	
ELSE
	V_ID = V_ID + 1;
	
END IF;

RETURN NVL(V_ID,-1); --- -1 IS THE ERROR FLAG

END GET_ID;
/

--- Calling this from a trigger

CREATE OR REPLACE TRIGGER TRG_GEN_ID
BEFORE INSERT ON Students
FOR EACH ROW
BEGIN

:NEW.SID := GET_ID(:NEW.YOE,:NEW.DEPT,:NEW.PROG);

END;
/

--- Test
INSERT INTO Students(Name, YOE, DEPT, PROG) VALUES ('A',18,4,2);
INSERT INTO Students(Name, YOE, DEPT, PROG) VALUES ('B',18,4,2);
INSERT INTO Students(Name, YOE, DEPT, PROG) VALUES ('C',18,4,2);

INSERT INTO Students(Name, YOE, DEPT, PROG) VALUES ('D',18,4,1);
INSERT INTO Students(Name, YOE, DEPT, PROG) VALUES ('E',18,4,1);